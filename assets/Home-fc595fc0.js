import{i as B,j as Y,k as j,p as q,l as F,n as V,o as L,q as tt,_ as et,f as at,r as st,v as ot,u as rt}from"./ErrorToast.vue_vue_type_script_setup_true_lang-43b39908.js";import{d as m,_,o as i,c as h,g as k,t as l,F as C,j as E,a,r as y,s as b,n as H,w as A,x as nt,y as it,C as G,z as K,A as I,B as dt,L as lt,D as ct,E as ht,G as ut,H as pt,I as yt,J as W,K as ft,M as R,m as mt,b as _t,v as Dt,N as bt,e as O,f as gt}from"./index-ecb6fdce.js";const wt=m({emits:["accordion-click"],props:{weatherData:{type:Object,required:!0}},mounted(){this.initTooltip()},methods:{formatDayInfo(t){return screen.width>=1024?B(t.datetime):Y(t.datetime)},toggleAccordion(t){this.$emit("accordion-click",t)},initTooltip:j("tooltip"),formatDate:B,parseConditions:q,parseConditionsToText:F,showPrecip:V}});const vt=["id"],Ct={class:"accordion-item"},$t=["id"],kt=["onClick","data-bs-target","aria-expanded","aria-controls"],xt={class:"icon-right"},Tt={class:"degree-right"},At=["id","aria-labelledby","data-bs-parent"],Ot={class:"accordion-body"},Lt={class:"table table-hover mt-2"},Pt=["title"];function St(t,e,o,c,s,r){return i(),h(C,null,[k(l(t.weatherData.description)+" ",1),(i(!0),h(C,null,E(t.weatherData.days,(n,d)=>(i(),h("div",{key:d,class:"accordion",id:"accordionDays"+d},[a("div",Ct,[a("h2",{class:"accordion-header",id:"heading"+d},[a("button",{onClick:p=>t.toggleAccordion(d),class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapse"+d,"aria-expanded":d===0,"aria-controls":"collapse"+d},[k(l(d===0?"Today":t.formatDayInfo(n))+" ",1),a("div",xt,l(t.parseConditions(n.icon)),1),a("div",Tt,l(Math.round(n.tempmax))+" º",1)],8,kt)],8,$t),a("div",{id:"collapse"+d,class:"accordion-collapse collapse","aria-labelledby":"heading"+d,"data-bs-parent":"#accordionDays"+d},[a("div",Ot,[a("table",Lt,[a("tbody",null,[(i(!0),h(C,null,E(n.hours,p=>(i(),h("tr",{key:p.datetime},[a("td",null,l(p.datetime.slice(0,5)),1),a("td",null,[a("h4",{ref_for:!0,ref:"tooltip",title:t.parseConditionsToText(p.icon)},l(t.parseConditions(p.icon)),9,Pt)]),a("td",null,l(Math.round(p.temp))+" º",1),a("td",null,l(t.showPrecip(p.precip)),1),a("td",null,l(Math.round(p.windspeed/3.6))+" m/s",1)]))),128))])])])],8,At)])],8,vt))),128))],64)}const Mt=_(wt,[["render",St]]),Nt=m({props:{weatherData:{type:Object,required:!0}},data(){return{todayData:this.weatherData.days[0]}},mounted(){this.initTooltip()},methods:{initTooltip:j("tooltip"),filterNextHours:L,parseConditions:q,parseConditionsToText:F,showPrecip:V}}),Et={class:"table table-hover mt-2"},Ht=["title"];function It(t,e,o,c,s,r){return i(),h(C,null,[k(l(t.todayData.description)+" ",1),a("table",Et,[a("tbody",null,[(i(!0),h(C,null,E(t.filterNextHours(t.todayData,t.weatherData),n=>(i(),h("tr",null,[a("td",null,l(n.datetime.slice(0,5)),1),a("td",null,[a("h4",{ref_for:!0,ref:"tooltip",title:t.parseConditionsToText(n.icon)},l(t.parseConditions(n.icon)),9,Ht)]),a("td",null,l(Math.round(n.temp))+" º",1),a("td",null,l(t.showPrecip(n.precip)),1),a("td",null,l(Math.round(n.windspeed/3.6))+" m/s",1)]))),256))])])],64)}const Wt=_(Nt,[["render",It]]),Bt=m({props:{weatherData:{type:Object,required:!0}},methods:{formatDateTime:tt}}),jt={class:"alert alert-warning alert-dismissible fade show",role:"alert"},qt={class:"alert-heading"},Ft=a("hr",null,null,-1),Vt={class:"mb-0"},Gt=a("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1);function Kt(t,e,o,c,s,r){return i(),h("div",jt,[a("h4",qt,l(t.weatherData.alerts[0].event),1),a("p",null,l(t.weatherData.alerts[0].description),1),Ft,a("p",Vt,[k(" Valid from "),a("b",null,l(t.formatDateTime(t.weatherData.alerts[0].onset)),1),k(" to "),a("b",null,l(t.formatDateTime(t.weatherData.alerts[0].ends)),1)]),Gt])}const Rt=_(Bt,[["render",Kt]]),Ut=m({emits:["accordion-click"],components:{WeatherData15Day:Mt,WeatherDataToday:Wt,Alerts:Rt},props:{weatherData:{type:Object,required:!0}},data(){return{today:!0}},methods:{handleAccordionClick(t){this.$emit("accordion-click",t)}}});const P=t=>(nt("data-v-1480d728"),t=t(),it(),t),zt={class:"row align-items-center"},Jt={class:"col-md"},Zt={class:"col-md-auto"},Qt={class:"nav justify-content-end"},Xt={key:0},Yt=P(()=>a("label",{class:"btn",for:"Today"},"Today",-1)),te={key:1},ee=P(()=>a("label",{class:"btn",for:"Today"},"Today",-1)),ae={key:2},se=P(()=>a("label",{class:"btn",for:"15Day"},"15 Day",-1)),oe={key:3},re=P(()=>a("label",{class:"btn",for:"15Day"},"15 Day",-1));function ne(t,e,o,c,s,r){const n=y("Alerts"),d=y("WeatherDataToday"),p=y("WeatherData15Day");return i(),h(C,null,[a("div",zt,[t.weatherData.alerts.length>0?(i(),b(n,{key:0,"weather-data":t.weatherData},null,8,["weather-data"])):H("",!0),a("div",Jt,[a("h2",null,l(t.weatherData.address),1)]),a("div",Zt,[a("nav",Qt,[t.today?(i(),h("div",Xt,[a("input",{type:"radio",class:"btn-check",id:"Today",onClick:e[0]||(e[0]=A(u=>{t.today=!0,t.handleAccordionClick(0)},["prevent"])),checked:""}),Yt])):(i(),h("div",te,[a("input",{type:"radio",class:"btn-check",id:"Today",onClick:e[1]||(e[1]=A(u=>{t.today=!0,t.handleAccordionClick(0)},["prevent"]))}),ee])),t.today?(i(),h("div",oe,[a("input",{type:"radio",class:"btn-check",id:"15Day",onClick:e[3]||(e[3]=A(u=>t.today=!1,["prevent"]))}),re])):(i(),h("div",ae,[a("input",{type:"radio",class:"btn-check",id:"15Day",onClick:e[2]||(e[2]=A(u=>t.today=!1,["prevent"])),checked:""}),se]))])])]),a("h5",null,l(t.weatherData.resolvedAddress),1),t.today?(i(),b(d,{key:0,"weather-data":t.weatherData},null,8,["weather-data"])):(i(),b(p,{key:1,"weather-data":t.weatherData,onAccordionClick:t.handleAccordionClick},null,8,["weather-data","onAccordionClick"]))],64)}const ie=_(Ut,[["render",ne],["__scopeId","data-v-1480d728"]]),U={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},de={ariaLabel:{type:String},ariaDescribedby:{type:String}},le={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...U,...de},ce=ct[0]==="2"?(t,e)=>Object.assign(t,{attrs:e}):(t,e)=>Object.assign(t,e);function v(t){return R(t)?W(t):t}function he(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return R(e)?new Proxy(t,{}):t}function ue(t,e){const o=t.options;o&&e&&Object.assign(o,e)}function z(t,e){t.labels=e}function J(t,e,o){const c=[];t.datasets=e.map(s=>{const r=t.datasets.find(n=>n[o]===s[o]);return!r||!s.data||c.includes(r)?{...s}:(c.push(r),Object.assign(r,s),r)})}function pe(t,e){const o={labels:[],datasets:[]};return z(o,t.labels),J(o,t.datasets,e),o}const ye=m({props:le,setup(t,e){let{expose:o,slots:c}=e;const s=ht(null),r=K(null);o({chart:r});const n=()=>{if(!s.value)return;const{type:u,data:g,options:f,plugins:$,datasetIdKey:S}=t,x=pe(g,S),D=he(x,g);r.value=new G(s.value,{type:u,data:D,options:{...f},plugins:$})},d=()=>{const u=W(r.value);u&&(t.destroyDelay>0?setTimeout(()=>{u.destroy(),r.value=null},t.destroyDelay):(u.destroy(),r.value=null))},p=u=>{u.update(t.updateMode)};return ut(n),pt(d),yt([()=>t.options,()=>t.data],(u,g)=>{let[f,$]=u,[S,x]=g;const D=W(r.value);if(!D)return;let T=!1;if(f){const w=v(f),M=v(S);w&&w!==M&&(ue(D,w),T=!0)}if($){const w=v($.labels),M=v(x.labels),N=v($.datasets),X=v(x.datasets);w!==M&&(z(D.config.data,w),T=!0),N&&N!==X&&(J(D.config.data,N,t.datasetIdKey),T=!0)}T&&ft(()=>{p(D)})},{deep:!0}),()=>I("canvas",{role:"img",ariaLabel:t.ariaLabel,ariaDescribedby:t.ariaDescribedby,ref:s},[I("p",{},[c.default?c.default():""])])}});function Z(t,e){return G.register(e),m({props:U,setup(o,c){let{expose:s}=c;const r=K(null),n=d=>{r.value=d==null?void 0:d.chart};return s({chart:r}),()=>I(ye,ce({ref:n},{type:t,...o}))}})}const fe=Z("bar",dt),Q=Z("line",lt),me=m({components:{Bar:fe},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Precipitation in mm",data:this.precipData,backgroundColor:"DeepSkyBlue",borderColor:"DeepSkyBlue"}]}},chartOptions(){return{responsive:!0,interaction:{intersect:!1},scales:{x:{grid:{display:!1}},y:{suggestedMax:5,grid:{display:!0}}}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},precipData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(parseFloat(e.precip.toFixed(1)))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(parseFloat(e.precip.toFixed(1)))}),t)}},methods:{filterNextHours:L}});function _e(t,e,o,c,s,r){const n=y("Bar");return i(),b(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const De=_(me,[["render",_e]]),be=m({components:{Line:Q},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Temperature in °C",data:this.tempData,backgroundColor:"orange",borderColor:"orange",tension:.4,pointRadius:0}]}},chartOptions(){return{scales:{x:{grid:{display:!1}},y:{grace:"100%",grid:{display:!0}}},responsive:!0,interaction:{intersect:!1}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},tempData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.temp))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.temp))}),t)}},methods:{filterNextHours:L}});function ge(t,e,o,c,s,r){const n=y("Line");return i(),b(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const we=_(be,[["render",ge]]),ve=m({components:{Line:Q},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Windspeed in m/s",data:this.windSpeedData,backgroundColor:"DeepPink",borderColor:"DeepPink",tension:.4,pointRadius:0},{label:"Windgusts in m/s",data:this.windGustsData,backgroundColor:"gray",borderColor:"gray",tension:.4,pointRadius:0}]}},chartOptions(){return{scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grace:"100%",grid:{display:!0}}},responsive:!0,interaction:{intersect:!1}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},windSpeedData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.windspeed/3.6))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.windspeed/3.6))}),t)},windGustsData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.windgust/3.6))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.windgust/3.6))}),t)}},methods:{filterNextHours:L}});function Ce(t,e,o,c,s,r){const n=y("Line");return i(),b(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const $e=_(ve,[["render",Ce]]),ke={components:{ContentLoader:et,WeatherOverview:ie,ErrorToast:at,PrecipChart:De,TempChart:we,WindChart:$e},data(){return{weatherData:null,loading:!1,city:localStorage.city,lastFetchedCity:localStorage.city,clickedAccordionIndex:0}},computed:{...mt(rt,["alertsList"])},mounted(){this.fetchData()},methods:{getLocation(){this.loading=!0;const t=o=>{const c=o.coords.latitude,s=o.coords.longitude;this.getCityNameFromCoordinates(c,s)},e=o=>{this.alertsList.push(o.message),this.loading=!1};navigator.geolocation.getCurrentPosition(t,e,{timeout:1e4,maximumAge:3e4})},async getCityNameFromCoordinates(t,e){try{const c=await(await fetch(st(t,e))).json();this.city=c.address.city||c.address.town,this.fetchData()}catch(o){this.alertsList.push(o.message),console.error(o)}},async fetchData(){if(!(this.city==null||this.city===""))try{[this.loading,this.lastFetchedCity]=[!0,this.city],localStorage.city=this.city;const e=await(await fetch(ot(this.city))).json();this.weatherData=e,this.clickedAccordionIndex=0}catch(t){console.error(t),this.alertsList.push(t.message)}finally{this.loading=!1}},handleAccordionClick(t){if(typeof t=="number")this.clickedAccordionIndex=t;else{const e="Invalid index:"+t;console.error(e),this.alertsList.push(e)}}}},xe={class:"row align-items-md-stretch"},Te={class:"col-md-6 mb-3"},Ae={class:"col-md-8 mb-3"},Oe={class:"input-group mb-3"},Le=["disabled"],Pe=["disabled"],Se=a("svg",{class:"pa-0 ma-0",width:"20",height:"20",fill:"#d40000",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:`M256 0c17.7 0 32 14.3 32 32V66.7C368.4 80.1 431.9 143.6 445.3 224H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H445.3C431.9 368.4 368.4 431.9 288 445.3V480c0 17.7-14.3
            32-32 32s-32-14.3-32-32V445.3C143.6 431.9 80.1 368.4 66.7 288H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H66.7C80.1 143.6 143.6 80.1 224 66.7V32c0-17.7 14.3-32 32-32zM128 256a128 128 0 1 0 256 0 128 128 0 1 0 -256 0zm128-80a80 80 0 1 1 0 160 80 80 0 1 1 0-160z`})],-1),Me=[Se],Ne={key:0,class:"col-md-6 mb-4"},Ee={class:"p-5"},He={class:"p-5"},Ie={class:"p-5"};function We(t,e,o,c,s,r){const n=y("WeatherOverview"),d=y("TempChart"),p=y("PrecipChart"),u=y("WindChart"),g=y("ContentLoader");return i(),h("div",xe,[a("div",Te,[a("div",Ae,[a("div",Oe,[_t(a("input",{"onUpdate:modelValue":e[0]||(e[0]=f=>s.city=f),type:"input",placeholder:"Enter a city to see its weather!",id:"inputCity",class:"form-control form-control-lg",onKeyup:e[1]||(e[1]=bt((...f)=>r.fetchData&&r.fetchData(...f),["enter"])),disabled:s.loading},null,40,Le),[[Dt,s.city]]),a("button",{type:"button",class:"btn btn-no-outline",onClick:e[2]||(e[2]=(...f)=>r.getLocation&&r.getLocation(...f)),disabled:s.loading},Me,8,Pe)])]),s.weatherData&&!s.loading?(i(),b(n,{key:0,"weather-data":s.weatherData,onAccordionClick:r.handleAccordionClick},null,8,["weather-data","onAccordionClick"])):H("",!0)]),O(g,{loading:s.loading},{default:gt(()=>[s.weatherData&&!s.loading?(i(),h("div",Ne,[a("div",Ee,[O(d,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])]),a("div",He,[O(p,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])]),a("div",Ie,[O(u,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])])])):H("",!0)]),_:1},8,["loading"])])}const qe=_(ke,[["render",We]]);export{qe as default};

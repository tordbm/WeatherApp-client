import{u as j,T as st,f as B,b as ot,i as F,p as V,d as q,s as G,e as E,h as rt,_ as nt,r as it,v as dt}from"./ContentLoader.vue_vue_type_script_setup_true_lang-77037c49.js";import{a as m,s as K,x as R,y as U,o as i,c as h,F as g,j as P,u as lt,e as a,t as d,_ as D,i as k,r as y,z as _,n as L,A,B as ct,C as ht,D as z,E as J,G as I,H as ut,L as pt,I as yt,J as ft,K as W,M as mt,N as Z,b as _t,g as Dt,v as bt,O as gt,f as O,w as wt}from"./index-ca4c0f65.js";const vt={class:"toast-container position-absolute top-0 end-0 p-3"},Ct=a("div",{class:"toast-header bg-danger text-dark"},[a("strong",{class:"me-auto"},"Error"),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"})],-1),$t={class:"toast-body box"},kt=m({__name:"ErrorToast",setup(t){const e=K(),o=j();return R(()=>{new st(e.value,{autohide:!1,delay:0})}),U(()=>{}),(l,s)=>(i(),h("div",vt,[(i(!0),h(g,null,P(lt(o).alertsList,r=>(i(),h("div",null,[a("div",{ref_for:!0,ref_key:"bsToast",ref:e,class:"toast show mt-2",role:"alert","aria-live":"assertive","aria-atomic":"true"},[Ct,a("div",$t,d(r),1)],512)]))),256))]))}}),Tt=m({emits:["accordion-click"],props:{weatherData:{type:Object,required:!0}},mounted(){this.initTooltip()},methods:{formatDayInfo(t){return screen.width>=1024?B(t.datetime):ot(t.datetime)},toggleAccordion(t){this.$emit("accordion-click",t)},initTooltip:F("tooltip"),formatDate:B,parseConditions:V,parseConditionsToText:q,showPrecip:G}});const xt=["id"],At={class:"accordion-item"},Ot=["id"],Lt=["onClick","data-bs-target","aria-expanded","aria-controls"],Pt={class:"icon-right"},Et={class:"degree-right"},St=["id","aria-labelledby","data-bs-parent"],Mt={class:"accordion-body"},Nt={class:"table table-hover mt-2"},Ht=["title"];function It(t,e,o,l,s,r){return i(),h(g,null,[k(d(t.weatherData.description)+" ",1),(i(!0),h(g,null,P(t.weatherData.days,(n,c)=>(i(),h("div",{key:c,class:"accordion",id:"accordionDays"+c},[a("div",At,[a("h2",{class:"accordion-header",id:"heading"+c},[a("button",{onClick:p=>t.toggleAccordion(c),class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapse"+c,"aria-expanded":c===0,"aria-controls":"collapse"+c},[k(d(c===0?"Today":t.formatDayInfo(n))+" ",1),a("div",Pt,d(t.parseConditions(n.icon)),1),a("div",Et,d(Math.round(n.tempmax))+" º",1)],8,Lt)],8,Ot),a("div",{id:"collapse"+c,class:"accordion-collapse collapse","aria-labelledby":"heading"+c,"data-bs-parent":"#accordionDays"+c},[a("div",Mt,[a("table",Nt,[a("tbody",null,[(i(!0),h(g,null,P(n.hours,p=>(i(),h("tr",{key:p.datetime},[a("td",null,d(p.datetime.slice(0,5)),1),a("td",null,[a("h4",{ref_for:!0,ref:"tooltip",title:t.parseConditionsToText(p.icon)},d(t.parseConditions(p.icon)),9,Ht)]),a("td",null,d(Math.round(p.temp))+" º",1),a("td",null,d(t.showPrecip(p.precip)),1),a("td",null,d(Math.round(p.windspeed/3.6))+" m/s",1)]))),128))])])])],8,St)])],8,xt))),128))],64)}const Wt=D(Tt,[["render",It]]),Bt=m({props:{weatherData:{type:Object,required:!0}},data(){return{todayData:this.weatherData.days[0]}},mounted(){this.initTooltip()},methods:{initTooltip:F("tooltip"),filterNextHours:E,parseConditions:V,parseConditionsToText:q,showPrecip:G}}),jt={class:"table table-hover mt-2"},Ft=["title"];function Vt(t,e,o,l,s,r){return i(),h(g,null,[k(d(t.todayData.description)+" ",1),a("table",jt,[a("tbody",null,[(i(!0),h(g,null,P(t.filterNextHours(t.todayData,t.weatherData),n=>(i(),h("tr",null,[a("td",null,d(n.datetime.slice(0,5)),1),a("td",null,[a("h4",{ref_for:!0,ref:"tooltip",title:t.parseConditionsToText(n.icon)},d(t.parseConditions(n.icon)),9,Ft)]),a("td",null,d(Math.round(n.temp))+" º",1),a("td",null,d(t.showPrecip(n.precip)),1),a("td",null,d(Math.round(n.windspeed/3.6))+" m/s",1)]))),256))])])],64)}const qt=D(Bt,[["render",Vt]]),Gt=m({props:{weatherData:{type:Object,required:!0}},methods:{formatDateTime:rt}}),Kt={class:"alert alert-warning alert-dismissible fade show",role:"alert"},Rt={class:"alert-heading"},Ut=a("hr",null,null,-1),zt={class:"mb-0"},Jt=a("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1);function Zt(t,e,o,l,s,r){return i(),h("div",Kt,[a("h4",Rt,d(t.weatherData.alerts[0].event),1),a("p",null,d(t.weatherData.alerts[0].description),1),Ut,a("p",zt,[k(" Valid from "),a("b",null,d(t.formatDateTime(t.weatherData.alerts[0].onset)),1),k(" to "),a("b",null,d(t.formatDateTime(t.weatherData.alerts[0].ends)),1)]),Jt])}const Qt=D(Gt,[["render",Zt]]),Xt=m({emits:["accordion-click"],components:{WeatherData15Day:Wt,WeatherDataToday:qt,Alerts:Qt},props:{weatherData:{type:Object,required:!0}},data(){return{today:!0}},methods:{handleAccordionClick(t){this.$emit("accordion-click",t)}}});const S=t=>(ct("data-v-1480d728"),t=t(),ht(),t),Yt={class:"row align-items-center"},te={class:"col-md"},ee={class:"col-md-auto"},ae={class:"nav justify-content-end"},se={key:0},oe=S(()=>a("label",{class:"btn",for:"Today"},"Today",-1)),re={key:1},ne=S(()=>a("label",{class:"btn",for:"Today"},"Today",-1)),ie={key:2},de=S(()=>a("label",{class:"btn",for:"15Day"},"15 Day",-1)),le={key:3},ce=S(()=>a("label",{class:"btn",for:"15Day"},"15 Day",-1));function he(t,e,o,l,s,r){const n=y("Alerts"),c=y("WeatherDataToday"),p=y("WeatherData15Day");return i(),h(g,null,[a("div",Yt,[t.weatherData.alerts.length>0?(i(),_(n,{key:0,"weather-data":t.weatherData},null,8,["weather-data"])):L("",!0),a("div",te,[a("h2",null,d(t.weatherData.address),1)]),a("div",ee,[a("nav",ae,[t.today?(i(),h("div",se,[a("input",{type:"radio",class:"btn-check",id:"Today",onClick:e[0]||(e[0]=A(u=>{t.today=!0,t.handleAccordionClick(0)},["prevent"])),checked:""}),oe])):(i(),h("div",re,[a("input",{type:"radio",class:"btn-check",id:"Today",onClick:e[1]||(e[1]=A(u=>{t.today=!0,t.handleAccordionClick(0)},["prevent"]))}),ne])),t.today?(i(),h("div",le,[a("input",{type:"radio",class:"btn-check",id:"15Day",onClick:e[3]||(e[3]=A(u=>t.today=!1,["prevent"]))}),ce])):(i(),h("div",ie,[a("input",{type:"radio",class:"btn-check",id:"15Day",onClick:e[2]||(e[2]=A(u=>t.today=!1,["prevent"])),checked:""}),de]))])])]),a("h5",null,d(t.weatherData.resolvedAddress),1),t.today?(i(),_(c,{key:0,"weather-data":t.weatherData},null,8,["weather-data"])):(i(),_(p,{key:1,"weather-data":t.weatherData,onAccordionClick:t.handleAccordionClick},null,8,["weather-data","onAccordionClick"]))],64)}const ue=D(Xt,[["render",he],["__scopeId","data-v-1480d728"]]),Q={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},pe={ariaLabel:{type:String},ariaDescribedby:{type:String}},ye={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...Q,...pe},fe=yt[0]==="2"?(t,e)=>Object.assign(t,{attrs:e}):(t,e)=>Object.assign(t,e);function $(t){return Z(t)?W(t):t}function me(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return Z(e)?new Proxy(t,{}):t}function _e(t,e){const o=t.options;o&&e&&Object.assign(o,e)}function X(t,e){t.labels=e}function Y(t,e,o){const l=[];t.datasets=e.map(s=>{const r=t.datasets.find(n=>n[o]===s[o]);return!r||!s.data||l.includes(r)?{...s}:(l.push(r),Object.assign(r,s),r)})}function De(t,e){const o={labels:[],datasets:[]};return X(o,t.labels),Y(o,t.datasets,e),o}const be=m({props:ye,setup(t,e){let{expose:o,slots:l}=e;const s=K(null),r=J(null);o({chart:r});const n=()=>{if(!s.value)return;const{type:u,data:w,options:v,plugins:f,datasetIdKey:M}=t,T=De(w,M),b=me(T,w);r.value=new z(s.value,{type:u,data:b,options:{...v},plugins:f})},c=()=>{const u=W(r.value);u&&(t.destroyDelay>0?setTimeout(()=>{u.destroy(),r.value=null},t.destroyDelay):(u.destroy(),r.value=null))},p=u=>{u.update(t.updateMode)};return R(n),U(c),ft([()=>t.options,()=>t.data],(u,w)=>{let[v,f]=u,[M,T]=w;const b=W(r.value);if(!b)return;let x=!1;if(v){const C=$(v),N=$(M);C&&C!==N&&(_e(b,C),x=!0)}if(f){const C=$(f.labels),N=$(T.labels),H=$(f.datasets),at=$(T.datasets);C!==N&&(X(b.config.data,C),x=!0),H&&H!==at&&(Y(b.config.data,H,t.datasetIdKey),x=!0)}x&&mt(()=>{p(b)})},{deep:!0}),()=>I("canvas",{role:"img",ariaLabel:t.ariaLabel,ariaDescribedby:t.ariaDescribedby,ref:s},[I("p",{},[l.default?l.default():""])])}});function tt(t,e){return z.register(e),m({props:Q,setup(o,l){let{expose:s}=l;const r=J(null),n=c=>{r.value=c==null?void 0:c.chart};return s({chart:r}),()=>I(be,fe({ref:n},{type:t,...o}))}})}const ge=tt("bar",ut),et=tt("line",pt),we=m({components:{Bar:ge},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Precipitation in mm",data:this.precipData,backgroundColor:"DeepSkyBlue",borderColor:"DeepSkyBlue"}]}},chartOptions(){return{responsive:!0,interaction:{intersect:!1},scales:{x:{grid:{display:!1}},y:{suggestedMax:5,grid:{display:!0}}}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},precipData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(parseFloat(e.precip.toFixed(1)))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(parseFloat(e.precip.toFixed(1)))}),t)}},methods:{filterNextHours:E}});function ve(t,e,o,l,s,r){const n=y("Bar");return i(),_(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const Ce=D(we,[["render",ve]]),$e=m({components:{Line:et},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Temperature in °C",data:this.tempData,backgroundColor:"orange",borderColor:"orange",tension:.4,pointRadius:0}]}},chartOptions(){return{scales:{x:{grid:{display:!1}},y:{grace:"100%",grid:{display:!0}}},responsive:!0,interaction:{intersect:!1}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},tempData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.temp))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.temp))}),t)}},methods:{filterNextHours:E}});function ke(t,e,o,l,s,r){const n=y("Line");return i(),_(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const Te=D($e,[["render",ke]]),xe=m({components:{Line:et},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Windspeed in m/s",data:this.windSpeedData,backgroundColor:"DeepPink",borderColor:"DeepPink",tension:.4,pointRadius:0},{label:"Windgusts in m/s",data:this.windGustsData,backgroundColor:"gray",borderColor:"gray",tension:.4,pointRadius:0}]}},chartOptions(){return{scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grace:"100%",grid:{display:!0}}},responsive:!0,interaction:{intersect:!1}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},windSpeedData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.windspeed/3.6))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.windspeed/3.6))}),t)},windGustsData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.windgust/3.6))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.windgust/3.6))}),t)}},methods:{filterNextHours:E}});function Ae(t,e,o,l,s,r){const n=y("Line");return i(),_(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const Oe=D(xe,[["render",Ae]]),Le={components:{ContentLoader:nt,WeatherOverview:ue,ErrorToast:kt,PrecipChart:Ce,TempChart:Te,WindChart:Oe},data(){return{weatherData:null,loading:!1,city:localStorage.city,lastFetchedCity:localStorage.city,clickedAccordionIndex:0}},computed:{..._t(j,["alertsList"])},mounted(){this.fetchData()},methods:{getLocation(){this.loading=!0;const t=o=>{const l=o.coords.latitude,s=o.coords.longitude;this.getCityNameFromCoordinates(l,s)},e=o=>{this.alertsList.push(o.message),this.loading=!1};navigator.geolocation.getCurrentPosition(t,e,{timeout:1e4,maximumAge:3e4})},async getCityNameFromCoordinates(t,e){try{const l=await(await fetch(it(t,e))).json();this.city=l.address.city||l.address.town,this.fetchData()}catch(o){this.alertsList.push(o.message),console.error(o)}},async fetchData(){if(!(this.city==null||this.city===""))try{[this.loading,this.lastFetchedCity]=[!0,this.city],localStorage.city=this.city;const e=await(await fetch(dt(this.city))).json();this.weatherData=e,this.clickedAccordionIndex=0}catch(t){console.error(t),this.alertsList.push(t.message)}finally{this.loading=!1}},handleAccordionClick(t){if(typeof t=="number")this.clickedAccordionIndex=t;else{const e="Invalid index:"+t;console.error(e),this.alertsList.push(e)}}}},Pe={class:"row align-items-md-stretch"},Ee={class:"col-md-6 mb-3"},Se={class:"col-md-8 mb-3"},Me={class:"input-group mb-3"},Ne=["disabled"],He=["disabled"],Ie=a("svg",{class:"pa-0 ma-0",width:"20",height:"20",fill:"#d40000",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:`M256 0c17.7 0 32 14.3 32 32V66.7C368.4 80.1 431.9 143.6 445.3 224H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H445.3C431.9 368.4 368.4 431.9 288 445.3V480c0 17.7-14.3
            32-32 32s-32-14.3-32-32V445.3C143.6 431.9 80.1 368.4 66.7 288H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H66.7C80.1 143.6 143.6 80.1 224 66.7V32c0-17.7 14.3-32 32-32zM128 256a128 128 0 1 0 256 0 128 128 0 1 0 -256 0zm128-80a80 80 0 1 1 0 160 80 80 0 1 1 0-160z`})],-1),We=[Ie],Be={key:0,class:"col-md-6 mb-4"},je={class:"p-5"},Fe={class:"p-5"},Ve={class:"p-5"};function qe(t,e,o,l,s,r){const n=y("ErrorToast"),c=y("WeatherOverview"),p=y("TempChart"),u=y("PrecipChart"),w=y("WindChart"),v=y("ContentLoader");return i(),h("div",Pe,[t.alertsList.length>0?(i(),_(n,{key:0})):L("",!0),a("div",Ee,[a("div",Se,[a("div",Me,[Dt(a("input",{"onUpdate:modelValue":e[0]||(e[0]=f=>s.city=f),type:"input",placeholder:"Enter a city to see its weather!",id:"inputCity",class:"form-control form-control-lg",onKeyup:e[1]||(e[1]=gt((...f)=>r.fetchData&&r.fetchData(...f),["enter"])),disabled:s.loading},null,40,Ne),[[bt,s.city]]),a("button",{type:"button",class:"btn btn-no-outline",onClick:e[2]||(e[2]=(...f)=>r.getLocation&&r.getLocation(...f)),disabled:s.loading},We,8,He)])]),s.weatherData&&!s.loading?(i(),_(c,{key:0,"weather-data":s.weatherData,onAccordionClick:r.handleAccordionClick},null,8,["weather-data","onAccordionClick"])):L("",!0)]),O(v,{loading:s.loading},{default:wt(()=>[s.weatherData&&!s.loading?(i(),h("div",Be,[a("div",je,[O(p,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])]),a("div",Fe,[O(u,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])]),a("div",Ve,[O(w,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])])])):L("",!0)]),_:1},8,["loading"])])}const Re=D(Le,[["render",qe]]);export{Re as default};

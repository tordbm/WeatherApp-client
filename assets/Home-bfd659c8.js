import{j as B,k as Y,l as j,p as q,n as F,o as V,q as L,r as tt,_ as et,i as at,u as st,t as ot,v as rt}from"./ErrorToast.vue_vue_type_script_setup_true_lang-d1088fb1.js";import{d as m,_,o as i,c as h,g as k,t as l,F as C,i as E,a,r as y,p as b,l as H,w as A,q as nt,s as it,C as G,x as K,y as I,B as dt,L as lt,z as ct,A as ht,D as ut,E as pt,G as yt,H as W,I as ft,J as R,b as mt,v as _t,K as Dt,e as O,f as bt}from"./index-399a4a8b.js";const gt=m({emits:["accordion-click"],props:{weatherData:{type:Object,required:!0}},mounted(){this.initTooltip()},methods:{formatDayInfo(t){return screen.width>=1024?B(t.datetime):Y(t.datetime)},toggleAccordion(t){this.$emit("accordion-click",t)},initTooltip:j("tooltip"),formatDate:B,parseConditions:q,parseConditionsToText:F,showPrecip:V}});const wt=["id"],vt={class:"accordion-item"},Ct=["id"],$t=["onClick","data-bs-target","aria-expanded","aria-controls"],kt={class:"icon-right"},xt={class:"degree-right"},Tt=["id","aria-labelledby","data-bs-parent"],At={class:"accordion-body"},Ot={class:"table table-hover mt-2"},Lt=["title"];function Pt(t,e,o,c,s,r){return i(),h(C,null,[k(l(t.weatherData.description)+" ",1),(i(!0),h(C,null,E(t.weatherData.days,(n,d)=>(i(),h("div",{key:d,class:"accordion",id:"accordionDays"+d},[a("div",vt,[a("h2",{class:"accordion-header",id:"heading"+d},[a("button",{onClick:p=>t.toggleAccordion(d),class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapse"+d,"aria-expanded":d===0,"aria-controls":"collapse"+d},[k(l(d===0?"Today":t.formatDayInfo(n))+" ",1),a("div",kt,l(t.parseConditions(n.icon)),1),a("div",xt,l(Math.round(n.tempmax))+" º",1)],8,$t)],8,Ct),a("div",{id:"collapse"+d,class:"accordion-collapse collapse","aria-labelledby":"heading"+d,"data-bs-parent":"#accordionDays"+d},[a("div",At,[a("table",Ot,[a("tbody",null,[(i(!0),h(C,null,E(n.hours,p=>(i(),h("tr",{key:p.datetime},[a("td",null,l(p.datetime.slice(0,5)),1),a("td",null,[a("h4",{ref_for:!0,ref:"tooltip",title:t.parseConditionsToText(p.icon)},l(t.parseConditions(p.icon)),9,Lt)]),a("td",null,l(Math.round(p.temp))+" º",1),a("td",null,l(t.showPrecip(p.precip)),1),a("td",null,l(Math.round(p.windspeed/3.6))+" m/s",1)]))),128))])])])],8,Tt)])],8,wt))),128))],64)}const St=_(gt,[["render",Pt]]),Mt=m({props:{weatherData:{type:Object,required:!0}},data(){return{todayData:this.weatherData.days[0]}},mounted(){this.initTooltip()},methods:{initTooltip:j("tooltip"),filterNextHours:L,parseConditions:q,parseConditionsToText:F,showPrecip:V}}),Nt={class:"table table-hover mt-2"},Et=["title"];function Ht(t,e,o,c,s,r){return i(),h(C,null,[k(l(t.todayData.description)+" ",1),a("table",Nt,[a("tbody",null,[(i(!0),h(C,null,E(t.filterNextHours(t.todayData,t.weatherData),n=>(i(),h("tr",null,[a("td",null,l(n.datetime.slice(0,5)),1),a("td",null,[a("h4",{ref_for:!0,ref:"tooltip",title:t.parseConditionsToText(n.icon)},l(t.parseConditions(n.icon)),9,Et)]),a("td",null,l(Math.round(n.temp))+" º",1),a("td",null,l(t.showPrecip(n.precip)),1),a("td",null,l(Math.round(n.windspeed/3.6))+" m/s",1)]))),256))])])],64)}const It=_(Mt,[["render",Ht]]),Wt=m({props:{weatherData:{type:Object,required:!0}},methods:{formatDateTime:tt}}),Bt={class:"alert alert-warning alert-dismissible fade show",role:"alert"},jt={class:"alert-heading"},qt=a("hr",null,null,-1),Ft={class:"mb-0"},Vt=a("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1);function Gt(t,e,o,c,s,r){return i(),h("div",Bt,[a("h4",jt,l(t.weatherData.alerts[0].event),1),a("p",null,l(t.weatherData.alerts[0].description),1),qt,a("p",Ft,[k(" Valid from "),a("b",null,l(t.formatDateTime(t.weatherData.alerts[0].onset)),1),k(" to "),a("b",null,l(t.formatDateTime(t.weatherData.alerts[0].ends)),1)]),Vt])}const Kt=_(Wt,[["render",Gt]]),Rt=m({emits:["accordion-click"],components:{WeatherData15Day:St,WeatherDataToday:It,Alerts:Kt},props:{weatherData:{type:Object,required:!0}},data(){return{today:!0}},methods:{handleAccordionClick(t){this.$emit("accordion-click",t)}}});const P=t=>(nt("data-v-1480d728"),t=t(),it(),t),Ut={class:"row align-items-center"},zt={class:"col-md"},Jt={class:"col-md-auto"},Zt={class:"nav justify-content-end"},Qt={key:0},Xt=P(()=>a("label",{class:"btn",for:"Today"},"Today",-1)),Yt={key:1},te=P(()=>a("label",{class:"btn",for:"Today"},"Today",-1)),ee={key:2},ae=P(()=>a("label",{class:"btn",for:"15Day"},"15 Day",-1)),se={key:3},oe=P(()=>a("label",{class:"btn",for:"15Day"},"15 Day",-1));function re(t,e,o,c,s,r){const n=y("Alerts"),d=y("WeatherDataToday"),p=y("WeatherData15Day");return i(),h(C,null,[a("div",Ut,[t.weatherData.alerts.length>0?(i(),b(n,{key:0,"weather-data":t.weatherData},null,8,["weather-data"])):H("",!0),a("div",zt,[a("h2",null,l(t.weatherData.address),1)]),a("div",Jt,[a("nav",Zt,[t.today?(i(),h("div",Qt,[a("input",{type:"radio",class:"btn-check",id:"Today",onClick:e[0]||(e[0]=A(u=>{t.today=!0,t.handleAccordionClick(0)},["prevent"])),checked:""}),Xt])):(i(),h("div",Yt,[a("input",{type:"radio",class:"btn-check",id:"Today",onClick:e[1]||(e[1]=A(u=>{t.today=!0,t.handleAccordionClick(0)},["prevent"]))}),te])),t.today?(i(),h("div",se,[a("input",{type:"radio",class:"btn-check",id:"15Day",onClick:e[3]||(e[3]=A(u=>t.today=!1,["prevent"]))}),oe])):(i(),h("div",ee,[a("input",{type:"radio",class:"btn-check",id:"15Day",onClick:e[2]||(e[2]=A(u=>t.today=!1,["prevent"])),checked:""}),ae]))])])]),a("h5",null,l(t.weatherData.resolvedAddress),1),t.today?(i(),b(d,{key:0,"weather-data":t.weatherData},null,8,["weather-data"])):(i(),b(p,{key:1,"weather-data":t.weatherData,onAccordionClick:t.handleAccordionClick},null,8,["weather-data","onAccordionClick"]))],64)}const ne=_(Rt,[["render",re],["__scopeId","data-v-1480d728"]]),U={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},ie={ariaLabel:{type:String},ariaDescribedby:{type:String}},de={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...U,...ie},le=ct[0]==="2"?(t,e)=>Object.assign(t,{attrs:e}):(t,e)=>Object.assign(t,e);function v(t){return R(t)?W(t):t}function ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return R(e)?new Proxy(t,{}):t}function he(t,e){const o=t.options;o&&e&&Object.assign(o,e)}function z(t,e){t.labels=e}function J(t,e,o){const c=[];t.datasets=e.map(s=>{const r=t.datasets.find(n=>n[o]===s[o]);return!r||!s.data||c.includes(r)?{...s}:(c.push(r),Object.assign(r,s),r)})}function ue(t,e){const o={labels:[],datasets:[]};return z(o,t.labels),J(o,t.datasets,e),o}const pe=m({props:de,setup(t,e){let{expose:o,slots:c}=e;const s=ht(null),r=K(null);o({chart:r});const n=()=>{if(!s.value)return;const{type:u,data:g,options:f,plugins:$,datasetIdKey:S}=t,x=ue(g,S),D=ce(x,g);r.value=new G(s.value,{type:u,data:D,options:{...f},plugins:$})},d=()=>{const u=W(r.value);u&&(t.destroyDelay>0?setTimeout(()=>{u.destroy(),r.value=null},t.destroyDelay):(u.destroy(),r.value=null))},p=u=>{u.update(t.updateMode)};return ut(n),pt(d),yt([()=>t.options,()=>t.data],(u,g)=>{let[f,$]=u,[S,x]=g;const D=W(r.value);if(!D)return;let T=!1;if(f){const w=v(f),M=v(S);w&&w!==M&&(he(D,w),T=!0)}if($){const w=v($.labels),M=v(x.labels),N=v($.datasets),X=v(x.datasets);w!==M&&(z(D.config.data,w),T=!0),N&&N!==X&&(J(D.config.data,N,t.datasetIdKey),T=!0)}T&&ft(()=>{p(D)})},{deep:!0}),()=>I("canvas",{role:"img",ariaLabel:t.ariaLabel,ariaDescribedby:t.ariaDescribedby,ref:s},[I("p",{},[c.default?c.default():""])])}});function Z(t,e){return G.register(e),m({props:U,setup(o,c){let{expose:s}=c;const r=K(null),n=d=>{r.value=d==null?void 0:d.chart};return s({chart:r}),()=>I(pe,le({ref:n},{type:t,...o}))}})}const ye=Z("bar",dt),Q=Z("line",lt),fe=m({components:{Bar:ye},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Precipitation in mm",data:this.precipData,backgroundColor:"DeepSkyBlue",borderColor:"DeepSkyBlue"}]}},chartOptions(){return{responsive:!0,interaction:{intersect:!1},scales:{x:{grid:{display:!1}},y:{suggestedMax:5,grid:{display:!0}}}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},precipData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(parseFloat(e.precip.toFixed(1)))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(parseFloat(e.precip.toFixed(1)))}),t)}},methods:{filterNextHours:L}});function me(t,e,o,c,s,r){const n=y("Bar");return i(),b(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const _e=_(fe,[["render",me]]),De=m({components:{Line:Q},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Temperature in °C",data:this.tempData,backgroundColor:"orange",borderColor:"orange",tension:.4,pointRadius:0}]}},chartOptions(){return{scales:{x:{grid:{display:!1}},y:{grace:"100%",grid:{display:!0}}},responsive:!0,interaction:{intersect:!1}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},tempData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.temp))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.temp))}),t)}},methods:{filterNextHours:L}});function be(t,e,o,c,s,r){const n=y("Line");return i(),b(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const ge=_(De,[["render",be]]),we=m({components:{Line:Q},props:{weatherData:{type:Object,required:!0},index:{type:Number,default:0}},computed:{chartData(){return{labels:this.labels,datasets:[{label:"Windspeed in m/s",data:this.windSpeedData,backgroundColor:"DeepPink",borderColor:"DeepPink",tension:.4,pointRadius:0},{label:"Windgusts in m/s",data:this.windGustsData,backgroundColor:"gray",borderColor:"gray",tension:.4,pointRadius:0}]}},chartOptions(){return{scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grace:"100%",grid:{display:!0}}},responsive:!0,interaction:{intersect:!1}}},todayData(){return this.weatherData.days[this.index]},labels(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(e.datetime.slice(0,5))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(e.datetime.slice(0,5))}),t)},windSpeedData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.windspeed/3.6))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.windspeed/3.6))}),t)},windGustsData(){let t=[];return this.index>0?(this.todayData.hours.forEach(e=>{t.push(Math.round(e.windgust/3.6))}),t):(this.filterNextHours(this.todayData,this.weatherData).forEach(e=>{t.push(Math.round(e.windgust/3.6))}),t)}},methods:{filterNextHours:L}});function ve(t,e,o,c,s,r){const n=y("Line");return i(),b(n,{data:t.chartData,options:t.chartOptions},null,8,["data","options"])}const Ce=_(we,[["render",ve]]),$e={components:{ContentLoader:et,WeatherOverview:ne,ErrorToast:at,PrecipChart:_e,TempChart:ge,WindChart:Ce},setup(){const{alertsList:t}=st();return{alertsList:t}},data(){return{weatherData:null,loading:!1,city:localStorage.city,lastFetchedCity:localStorage.city,clickedAccordionIndex:0}},mounted(){this.fetchData()},methods:{getLocation(){this.loading=!0;const t=o=>{const c=o.coords.latitude,s=o.coords.longitude;this.getCityNameFromCoordinates(c,s)},e=o=>{this.alertsList.push(o.message),this.loading=!1};navigator.geolocation.getCurrentPosition(t,e,{timeout:1e4,maximumAge:3e4})},async getCityNameFromCoordinates(t,e){try{const c=await(await fetch(ot(t,e))).json();this.city=c.address.city||c.address.town,this.fetchData()}catch(o){this.alertsList.push(o.message),console.error(o)}},async fetchData(){if(!(this.city==null||this.city===""))try{[this.loading,this.lastFetchedCity]=[!0,this.city],localStorage.city=this.city;const e=await(await fetch(rt(this.city))).json();this.weatherData=e,this.clickedAccordionIndex=0}catch(t){console.error(t),this.alertsList.push(t.message)}finally{this.loading=!1}},handleAccordionClick(t){if(typeof t=="number")this.clickedAccordionIndex=t;else{const e="Invalid index:"+t;console.error(e),this.alertsList.push(e)}}}},ke={class:"row align-items-md-stretch"},xe={class:"col-md-6 mb-3"},Te={class:"col-md-8 mb-3"},Ae={class:"input-group mb-3"},Oe=["disabled"],Le=["disabled"],Pe=a("svg",{class:"pa-0 ma-0",width:"20",height:"20",fill:"#d40000",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:`M256 0c17.7 0 32 14.3 32 32V66.7C368.4 80.1 431.9 143.6 445.3 224H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H445.3C431.9 368.4 368.4 431.9 288 445.3V480c0 17.7-14.3
            32-32 32s-32-14.3-32-32V445.3C143.6 431.9 80.1 368.4 66.7 288H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H66.7C80.1 143.6 143.6 80.1 224 66.7V32c0-17.7 14.3-32 32-32zM128 256a128 128 0 1 0 256 0 128 128 0 1 0 -256 0zm128-80a80 80 0 1 1 0 160 80 80 0 1 1 0-160z`})],-1),Se=[Pe],Me={key:0,class:"col-md-6 mb-4"},Ne={class:"p-5"},Ee={class:"p-5"},He={class:"p-5"};function Ie(t,e,o,c,s,r){const n=y("WeatherOverview"),d=y("TempChart"),p=y("PrecipChart"),u=y("WindChart"),g=y("ContentLoader");return i(),h("div",ke,[a("div",xe,[a("div",Te,[a("div",Ae,[mt(a("input",{"onUpdate:modelValue":e[0]||(e[0]=f=>s.city=f),type:"input",placeholder:"Enter a city to see its weather!",id:"inputCity",class:"form-control form-control-lg",onKeyup:e[1]||(e[1]=Dt((...f)=>r.fetchData&&r.fetchData(...f),["enter"])),disabled:s.loading},null,40,Oe),[[_t,s.city]]),a("button",{type:"button",class:"btn btn-no-outline",onClick:e[2]||(e[2]=(...f)=>r.getLocation&&r.getLocation(...f)),disabled:s.loading},Se,8,Le)])]),s.weatherData&&!s.loading?(i(),b(n,{key:0,"weather-data":s.weatherData,onAccordionClick:r.handleAccordionClick},null,8,["weather-data","onAccordionClick"])):H("",!0)]),O(g,{loading:s.loading},{default:bt(()=>[s.weatherData&&!s.loading?(i(),h("div",Me,[a("div",Ne,[O(d,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])]),a("div",Ee,[O(p,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])]),a("div",He,[O(u,{"weather-data":s.weatherData,index:s.clickedAccordionIndex},null,8,["weather-data","index"])])])):H("",!0)]),_:1},8,["loading"])])}const je=_($e,[["render",Ie]]);export{je as default};

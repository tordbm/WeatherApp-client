import{d as v,_ as k,r as g,o as l,c as i,a as s,w as E,b as m,v as p,e as r,f as _,g as f,F as M,h as L,i as N,u as c,n as P,j as D,k as W,t as V,l as R,m as T,p as I,q as A}from"./index-B8Qzu0D6.js";import{_ as U,u as w,s as B,M as y,l as x,m as q,d as z,e as F,a as j}from"./ErrorToast.vue_vue_type_script_setup_true_lang-xBLJ4rWB.js";const H="/WeatherApp-client/assets/partially-sunny-B0Tv6pHN.png",G=v({components:{ContentLoader:U},setup(){return{store:w()}},data(){return{username:"",email:"",password:"",controlPassword:"",loading:!1}},computed:{passwordsMatch(){return this.password===this.controlPassword}},methods:{async signup(){if(!this.passwordsMatch){this.store.addError("Passwords do not match");return}try{this.loading=!0,await B(this.username,this.email,this.password)}catch{this.store.addError("Username or email already exists");return}finally{this.loading=!1}const e=this.$refs.signupModal;y.getInstance(e).hide(),this.$emit("signedUp",this.username,this.password)}}}),J={ref:"signupModal",class:"modal fade",tabindex:"-1","aria-labelledby":"signupModalLabel","aria-hidden":"true"},K={class:"modal-dialog"},O={class:"modal-content"},Q=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"signupModalLabel"},"Sign up"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),X={class:"modal-body"},Y={class:"mb-4 form-floating"},Z=s("label",{for:"username",class:"form-label"},"Username",-1),ss={class:"mb-4 form-floating"},es=s("label",{for:"email",class:"form-label"},"Email address",-1),ts={class:"mb-4 form-floating"},os=s("label",{for:"password",class:"form-label"},"Password",-1),as={class:"mb-4 form-floating"},ns=s("label",{for:"controlPassword",class:"form-label"},"Repeat password",-1),ls={class:"modal-footer"},is={type:"submit",class:"btn btn-success"};function rs(e,t,a,h,u,$){const b=g("ContentLoader");return l(),i("div",J,[s("div",K,[s("div",O,[Q,s("div",X,[s("form",{onSubmit:t[4]||(t[4]=E((...o)=>e.signup&&e.signup(...o),["prevent"]))},[s("div",Y,[m(s("input",{type:"username",class:"form-control",id:"username","onUpdate:modelValue":t[0]||(t[0]=o=>e.username=o),placeholder:"Username",required:""},null,512),[[p,e.username]]),Z]),s("div",ss,[m(s("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[1]||(t[1]=o=>e.email=o),placeholder:"Email address",required:""},null,512),[[p,e.email]]),es]),s("div",ts,[m(s("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[2]||(t[2]=o=>e.password=o),placeholder:"Password",required:""},null,512),[[p,e.password]]),os]),s("div",as,[m(s("input",{type:"password",class:"form-control",id:"controlPassword","onUpdate:modelValue":t[3]||(t[3]=o=>e.controlPassword=o),placeholder:"Repeat password",required:""},null,512),[[p,e.controlPassword]]),ns]),s("div",ls,[s("button",is,[r(b,{loading:e.loading},{default:_(()=>[f(" Sign up ")]),_:1},8,["loading"])])])],32)])])])],512)}const ds=k(G,[["render",rs]]),cs=v({components:{ContentLoader:U,SignupModal:ds},setup(){return{store:w()}},data(){return{username:null,password:null,loading:!1}},methods:{async loginUser(){try{this.loading=!0,await x(this.username,this.password)}catch{this.store.addError("Invalid username or password"),this.loading=!1;return}await q();const e=this.$refs.loginModal;y.getInstance(e).hide(),this.loading=!1},setCredentials(e,t){const a=this.$refs.loginModal;y.getInstance(a).show(),this.username=e,this.password=t,this.loginUser()}}}),us={id:"loginModal",ref:"loginModal",class:"modal fade",tabindex:"-1","aria-labelledby":"loginModalLabel","aria-hidden":"true"},ms={class:"modal-dialog"},ps={class:"modal-content"},hs=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"loginModalLabel"},"Sign in"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),bs={class:"modal-body"},_s={class:"mb-4 form-floating"},gs=["disabled"],fs=s("label",{for:"usernameInput",class:"form-label"},"Username",-1),vs={class:"mb-3 form-floating"},ws=["disabled"],$s=s("label",{for:"inputPassword",class:"form-label"},"Password",-1),ys=["disabled"],ks={class:"modal-footer"},Ms={type:"submit",class:"btn btn-success"};function Us(e,t,a,h,u,$){const b=g("ContentLoader"),o=g("SignupModal");return l(),i(M,null,[s("div",us,[s("div",ms,[s("div",ps,[hs,s("form",{onSubmit:t[2]||(t[2]=E((...n)=>e.loginUser&&e.loginUser(...n),["prevent"]))},[s("div",bs,[s("div",_s,[m(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.username=n),type:"username",class:"form-control",id:"usernameInput","aria-describedby":"usernamelHelp",disabled:e.loading,placeholder:"Username",required:""},null,8,gs),[[p,e.username]]),fs]),s("div",vs,[m(s("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>e.password=n),type:"password",class:"form-control",id:"inputPassword",disabled:e.loading,placeholder:"Password",required:""},null,8,ws),[[p,e.password]]),$s]),s("button",{type:"button",class:"btn btn-link","data-bs-target":"#signupModal","data-bs-toggle":"modal",disabled:e.loading}," Don't have an account? Sign up ",8,ys)]),s("div",ks,[s("button",Ms,[r(b,{loading:e.loading},{default:_(()=>[f(" Sign in ")]),_:1},8,["loading"])])])],32)])])],512),r(o,{id:"signupModal",onSignedUp:e.setCredentials},null,8,["onSignedUp"])],64)}const Cs=k(cs,[["render",Us]]),Ss={class:"container"},Ls=s("img",{src:H,alt:"Sun behind cloud",height:"50"},null,-1),Ps=s("button",{class:"navbar-toggler border-0 shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation"},[s("span",{class:"navbar-toggler-icon"})],-1),Vs={class:"collapse navbar-collapse",id:"navbarNavDropdown"},Is={class:"navbar-nav ms-auto"},Es={key:0,class:"bi bi-house-fill"},Ns={class:"nav-item"},Ws={key:0},qs={class:"nav-item dropdown"},Ds={class:"btn btn-no-outline nav-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Rs={key:1,class:"nav-item"},Ts=s("button",{class:"btn btn-no-outline nav-link text-uppercase",type:"button","data-bs-toggle":"modal","data-bs-target":"#loginModal","aria-expanded":"true"}," Sign in ",-1),As=[Ts],Bs=v({__name:"Nav",setup(e){const t=T(),a=w(),h=L(()=>t.currentRoute.value.path),u=L(()=>a.theme),$=n=>n===h.value;function b(){z("accesstoken"),a.currentUser=null}function o(n){document.documentElement.setAttribute("data-bs-theme",n),a.setTheme(n)}return N(()=>{o(localStorage.theme||"light")}),(n,C)=>{const S=g("router-link");return l(),i("div",{class:"navbar navbar-expand-lg border-bottom mb-4",style:R(c(a).theme==="light"?"background-color: azure":"background-color: indigo")},[s("nav",Ss,[r(S,{to:c(I)[0].path,class:"navbar-brand d-flex align-items-center"},{default:_(()=>[Ls,f(" World Wide Weather ")]),_:1},8,["to"]),s("button",{class:"btn btn-no-outline nav-link text-uppercase",onClick:C[0]||(C[0]=d=>o(u.value==="light"?"dark":"light"))},[s("i",{class:P(u.value==="light"?"bi bi-moon-stars-fill":"bi bi-sun-fill")},null,2)]),Ps,s("div",Vs,[s("ul",Is,[(l(!0),i(M,null,D(c(I),d=>(l(),i("li",{class:"nav-item text-uppercase",key:d.path},[r(S,{to:d.path,class:P(["nav-link",{active:$(d.path)}]),title:d.children[0].name},{default:_(()=>[d.path==="/"?(l(),i("i",Es)):W("",!0),f(" "+V(d.path!=="/"?d.children[0].name:""),1)]),_:2},1032,["to","title","class"])]))),128)),s("li",Ns,[r(U,{loading:!c(a).currentUser&&c(F)("accesstoken")},{default:_(()=>[c(a).currentUser?(l(),i("li",Ws,[s("div",qs,[s("button",Ds,V(c(a).currentUser.username),1),s("ul",{class:"dropdown-menu"},[s("li",null,[s("a",{class:"dropdown-item text-danger",onClick:b},"Sign out")])])])])):(l(),i("li",Rs,As))]),_:1},8,["loading"]),r(Cs)])])])])],4)}}}),xs={},zs={class:"border-top py-3 d-flex justify-content-between align-items-center"},Fs=s("section",null,[s("a",{href:"https://github.com/tordbm/WeatherApp-client",class:"text-decoration-none",title:"Wheather app by TordBM"},"tordbm"),s("a",{href:"https://github.com/tordbm/WeatherApp-client",class:"text-decoration-none ms-1",title:"Wheather App in Vue3"},[s("i",{class:"bi bi-github"})])],-1),js=[Fs];function Hs(e,t){return l(),i("div",zs,js)}const Gs=k(xs,[["render",Hs]]),Js={class:"container flex-shrink-0 mb-4 mt-4"},Ks={class:"container footer mb-2 mt-auto"},Xs=v({__name:"Default",setup(e){const{errorsList:t}=w();return N(()=>{q()}),(a,h)=>{const u=g("RouterView");return l(),i(M,null,[r(Bs),c(t).length>0?(l(),A(j,{key:0})):W("",!0),s("main",Js,[r(u)]),s("footer",Ks,[r(Gs)])],64)}}});export{Xs as default};
